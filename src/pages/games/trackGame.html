<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial=scale=1.0"/>
    <title>Game Dash</title>
    <meta name="description" content="Track a game page for BBallStatTrack"/>
    <meta name="author" content="Jaylen Guerrero"/>
    <link rel="stylesheet" href="/pages/games/styles/trackGame.css">
    <link rel="stylesheet" href="/pages/style/nav.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">

</head>
<body>
    <div id="lineupPanel">
        <h2>Current Lineup</h2>
        <div id="playerList">
            <!-- Player check box here -->
        </div>
    </div>
    <div id="playerCards">
        <div id="playerInfo">

        </div>
        <div class="statButtons">

        </div>

    </div>




    <script>
document.addEventListener("DOMContentLoaded", () => {
  const pathSegments = window.location.pathname.split('/');
  const teamId = pathSegments[2];
  const playerList = document.getElementById("playerList");
  const playerInfo = document.getElementById("playerInfo");

  fetch(`/teamInfo?id=${teamId}`)
    .then(res => res.json())
    .then(data => {
      const players = data.roster;

      players.forEach(player => {
        const div = document.createElement("div");
        div.classList.add("playerItem");

        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = `player-${player.id}`;
        checkbox.value = player.id;
        checkbox.dataset.firstName = player.firstName;
        checkbox.dataset.lastName = player.lastName;

        const label = document.createElement("label");
        label.htmlFor = checkbox.id;
        label.textContent = `${player.firstName} ${player.lastName}`;

        div.appendChild(checkbox);
        div.appendChild(label);
        playerList.appendChild(div);
      });

      playerList.addEventListener('change', e => {
        // Limit 5 players max
        const checkedBoxes = playerList.querySelectorAll('input[type="checkbox"]:checked');
        if (checkedBoxes.length > 5) {
          e.target.checked = false;
          alert('Only 5 players can be selected at once');
          return;
        }
        updatePlayerCards();
      });
    })
    .catch(err => {
      console.error("Error loading team info:", err);
    });

  function updatePlayerCards() {
    playerInfo.innerHTML = '';

    const checkedBoxes = playerList.querySelectorAll('input[type="checkbox"]:checked');

    checkedBoxes.forEach(box => {
      const firstName = box.dataset.firstName;
      const lastName = box.dataset.lastName;
      const playerId = box.value;

      const card = document.createElement("div");
      card.classList.add("player-card");
      card.dataset.playerId = playerId;

      const nameDiv = document.createElement("div");
      nameDiv.classList.add("player-name");
      nameDiv.textContent = `${firstName} ${lastName}`;
      card.appendChild(nameDiv);

      const statButtonDiv = document.createElement("div");
      statButtonDiv.classList.add("stat-buttons");

      const stats = [
        { key: "2PtFg", label: "+2 Pt Fg" },
        { key: "2PtFgMiss", label: "2 Pt Fg Miss" },
        { key: "3PtFg", label: "+3 Pt Fg" },
        { key: "3PtFgMiss", label: "3 Pt Fg Miss" },
        { key: "assist", label: "+1 Assist" },
        { key: "rebound", label: "+1 Rebound" },
        { key: "steal", label: "+1 Steal" },
        { key: "block", label: "+1 Block" },
        { key: "turnover", label: "+1 Turnover" }
      ];

      stats.forEach(stat => {
        const btn = document.createElement("button");
        btn.classList.add("statBtn");
        btn.dataset.stat = stat.key;
        btn.textContent = stat.label;

        btn.addEventListener('click', () => {
          console.log(`Player ${firstName} ${lastName} scored stat: ${stat.key}`);
          // You can add stat update logic here later
        });

        statButtonDiv.appendChild(btn);
      });

      card.appendChild(statButtonDiv);
      playerInfo.appendChild(card);
    });
  }
});

</script>


</body>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial=scale=1.0"/>
    <title>New Game</title>
    <meta name="description" content="Create a game page for BBallStatTrack"/>
    <meta name="author" content="Jaylen Guerrero"/>
    <link rel="stylesheet" href="/pages/seasonDash/style/seasonDash.css">
    <link rel="stylesheet" href="/pages/style/nav.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">

</head>
<body>
    <nav>
        <div class="name">BBallStatTrack</div>
        <div class="navLinks">
            <a href="/">Home</a>
            <a href="/create">Create</a>
            <a href="/stats">Stats</a>
            <a href="/teamsPage">Teams</a>
            <a href="/account">Account</a>
            <a href="/about">About</a>
    </nav>

    <div id="input1">
        <form>
            <div id="labels">
                <label for="opponent">Opponent: </label>
            </div>
            <div id="inputs">
                <input type="text" id="opponent" placeholder="Opponent">
            </div>
            <div id="labels">
                <label for="location">Location: </label>
            </div>
            <div id="inputs">
                <input type="text" id="location" placeholder="Location">
            </div>  
            <div id="labels">
                <label for="date">Date: </label>
            </div>
            <div id="inputs">
                <input type="date" id="date" placeholder="Date"> 
            </div>  
            <div  id="submit">
                <input type="submit" value="Start Game">
            </div>
            <div id="message"></div>
            
    </form>

    <script>

    document.getElementById('input1').addEventListener('submit', async (e) => {
        e.preventDefault();

        const opponent = document.getElementById('opponent').value;
        const location = document.getElementById('location').value;
        const date = document.getElementById('date').value;

        if (!opponent || !location || !date ) {
            document.getElementById("message").innerHTML = "<p>Error: All fields must be filled.</p>";
            return;
        }

        try {

            const response = await fetch('/startGame', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({opponent, location, date}),
            });

            const result = await response.json();

            if (response.ok) {
                console.log("Player created successfully");
                document.getElementById("firstName").value = "";
                document.getElementById("lastName").value = "";
                document.getElementById("position").value = "";
                document.getElementById("height").value = "";
                document.getElementById("weight").value = "";
                document.getElementById("teamId").value = "";
                document.getElementById("message").innerHTML = "<p>Player Created Successfully</p>";
                document.getElementById("playerLink").innerHTML = "<a id=\"playerLink\" href=\"stats\">See Player Here</a>";
            } else {
                console.error("Error creating team", result.message);
                console.log("Team created successfully");
                document.getElementById("firstName").value = "";
                document.getElementById("lastName").value = "";
                document.getElementById("position").value = "";
                document.getElementById("height").value = "";
                document.getElementById("weight").value = "";
                document.getElementById("teamId").value = "";
                document.getElementById("message").innerHTML = "<p>Error: Player Could Not Be Created</p>";
            }

        } catch (error) {
            console.error("Server error: ", error);
        }



        });

    </script>




</body>